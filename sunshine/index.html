<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Engagement — [Your Names]</title>
  <meta name="description" content="Scroll past luxe 3×2 grids to reveal the news. Pretentious on purpose." />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <style>
    /* ——— Fonts & palette ——— */
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Poppins:wght@300;500;700&display=swap');
    :root{
      --ink:#f7ecff;         /* light text */
      --bg-deep:#0b0613;     /* near-black plum */
      --lav:#c8a2ff;         /* lavender accent */
      --fuchsia:#ff4db3;     /* punch */
      --gold:#ffd08a;        /* luxe */
      --tile:rgba(255,255,255,.04); /* cell fill */
    }

    html,body{height:100%}
    body{
      margin:0; color:var(--ink);
      font-family:'Poppins', system-ui, sans-serif; letter-spacing:.01em;
      background-color: var(--bg-deep);
      scroll-snap-type:y mandatory;
      overscroll-behavior-y:none;
    }

    /* Global background (fixed) so panels blend seamlessly */
    .bg-global{position:fixed; inset:0; z-index:-1;
      background:
        radial-gradient(50% 40% at 20% 20%, rgba(200,162,255,.22), transparent 70%),
        radial-gradient(40% 45% at 80% 25%, rgba(255,77,179,.18), transparent 70%),
        radial-gradient(60% 50% at 50% 80%, rgba(255,208,138,.18), transparent 70%),
        linear-gradient(180deg, #13091d 0%, #0b0613 100%);
      filter: saturate(110%) contrast(105%);
      animation: pan 18s linear infinite;
    }
    @keyframes pan{ 0%{ background-position:0 0, 0 0, 0 0, 0 0 } 50%{ background-position:10% 6%, -8% 4%, 0% 12%, 0 0 } 100%{ background-position:0 0, 0 0, 0 0, 0 0 } }

    /* Panels */
    .panel{min-height:100svh; position:relative; scroll-snap-align:start; display:flex; align-items:center; justify-content:center}

    .center-wrap{position:relative; z-index:1; width:min(92vw, 980px); padding:clamp(16px, 3vw, 40px)}

    /* 3×2 grid: seamless (no gaps); rounded outer mask */
    .grid-mask{border-radius:1.25rem; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .nine{position:relative; display:grid; grid-template-columns:repeat(3,1fr); grid-template-rows:repeat(2,1fr); gap:0; width:100%; aspect-ratio:3/2}
    .cell{background:var(--tile); min-height:90px; opacity:0; transform:translateY(22px)}

    /* Staggered rise-in for cells */
    @keyframes rise{from{opacity:0; transform:translateY(22px)} to{opacity:1; transform:none}}
    .nine.in .cell{animation:rise .7s cubic-bezier(.2,.7,.2,1) both}
    .nine.in .cell:nth-child(1){animation-delay:.04s}
    .nine.in .cell:nth-child(2){animation-delay:.10s}
    .nine.in .cell:nth-child(3){animation-delay:.16s}
    .nine.in .cell:nth-child(4){animation-delay:.22s}
    .nine.in .cell:nth-child(5){animation-delay:.28s}
    .nine.in .cell:nth-child(6){animation-delay:.34s}

    /* Headline overlays the grid (doesn't occupy a cell) */
    .headline{position:absolute; inset:0; display:grid; place-items:center; pointer-events:none}
    .headline h1{font-family:'Cormorant Garamond', serif; font-weight:700; letter-spacing:.22em; text-transform:uppercase; font-size:clamp(2rem, 8vw, 5.2rem); line-height:1; text-shadow:0 12px 34px rgba(0,0,0,.55)}

    .label{position:absolute; top:6vh; left:50%; transform:translateX(-50%); font-family:'Cormorant Garamond', serif; letter-spacing:.35em; text-transform:uppercase; font-size:.9rem; opacity:.85}
    .cue{position:absolute; left:50%; bottom:24px; transform:translateX(-50%); font-size:.8rem; letter-spacing:.2em; text-transform:uppercase; opacity:.85}

    /* Final panel: photo reveal */
    .photo-wrap{position:absolute; inset:0; display:grid; place-items:center; opacity:0; pointer-events:none}
    .photo{max-width:min(92vw, 980px); width:100%; border-radius:1.25rem; box-shadow:0 20px 50px rgba(0,0,0,.45)}
    .photo.low{filter:blur(18px) saturate(110%); transform:scale(1.03)}
    .photo.hi{opacity:0}

    /* Fade-in on scroll */
    .fade-in{opacity:0; transform:translateY(14px); transition:opacity .7s ease, transform .7s ease}
    .fade-in.is-in{opacity:1; transform:none}

    /* Confetti canvas */
    #confetti{position:fixed; inset:0; pointer-events:none; z-index:9999}

    /* Mobile tweaks */
    @media (max-width:576px){ .label{top:3vh} }
  </style>
</head>
<body>
  <div class="bg-global" aria-hidden="true"></div>
  <main>
    <!-- PANEL 1: WE -->
    <section class="panel" aria-label="We">
      <div class="label">I</div>
      <div class="center-wrap">
        <div class="grid-mask">
          <div class="nine" data-animate="cells">
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
          </div>
        </div>
        <div class="headline"><h1>WE</h1></div>
        <div class="cue">Scroll</div>
      </div>
    </section>

    <!-- PANEL 2: ARE -->
    <section class="panel" aria-label="Are">
      <div class="label">II</div>
      <div class="center-wrap">
        <div class="grid-mask">
          <div class="nine" data-animate="cells">
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
          </div>
        </div>
        <div class="headline"><h1>ARE</h1></div>
        <div class="cue">Scroll</div>
      </div>
    </section>

    <!-- PANEL 3: ENGAGED (scroll-driven headline + photo reveal) -->
    <section class="panel" id="final" aria-label="Engaged">
      <div class="label">III</div>
      <div class="center-wrap">
        <div class="grid-mask" id="finalGridMask">
          <div class="nine" id="finalNine" data-animate="cells">
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>
          </div>
        </div>
        <div class="headline"><h1 id="finalWord">ENGAGED</h1></div>
        <div class="photo-wrap" id="finalPhotoWrap" aria-hidden="true">
          <img class="photo low" id="finalPhotoLow" src="pen.jpg" alt="Announcement"/>
          <img class="photo hi" id="finalPhotoHi" src="pen.jpg" alt="Announcement high-resolution"/>
        </div>
      </div>
    </section>
  </main>

  <canvas id="confetti" width="0" height="0" hidden></canvas>

  <script>
    // Always start at top on refresh / bfcache restore
    (function(){
      if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
      window.scrollTo(0,0);
      window.addEventListener('pageshow', function(e){ if (e.persisted) window.scrollTo(0,0); });
    })();

    // Stagger cell animations when grids enter
    (function(){
      var grids = document.querySelectorAll('.nine[data-animate="cells"]');
      if(!('IntersectionObserver' in window)){ grids.forEach(function(g){ g.classList.add('in'); }); return; }
      var io = new IntersectionObserver(function(entries){
        entries.forEach(function(e){ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target);} });
      },{threshold:0.25});
      grids.forEach(function(g){ io.observe(g); });
    })();

    // Final panel scroll-driven animation
    (function(){
      var panel = document.getElementById('final');
      var word  = document.getElementById('finalWord');
      var grid  = document.getElementById('finalNine');
      var gridMask = document.getElementById('finalGridMask');
      var wrap  = document.getElementById('finalPhotoWrap');
      var low   = document.getElementById('finalPhotoLow');
      var hi    = document.getElementById('finalPhotoHi');
      var hiReady=false, fired=false, canRetrigger=false;

      hi.addEventListener('load', function(){ hiReady=true; });

      function lerp(a,b,t){ return a + (b-a)*t; }
      function smoothstep(e0,e1,x){ var t=Math.min(1, Math.max(0, (x-e0)/(e1-e0))); return t*t*(3-2*t); }

      function onScroll(){
        var r = panel.getBoundingClientRect();
        var vh = innerHeight || document.documentElement.clientHeight;
        var p = Math.min(1, Math.max(0, (vh - r.top) / (r.height))); // 0..1 through the panel

        // Word grows and moves upward as you scroll
        var scale = lerp(0.65, 1.15, smoothstep(0.05, 0.7, p));
        var y = lerp(0, -vh*0.24, smoothstep(0.25, 0.9, p));
        word.style.transform = 'translate3d(0,'+y+'px,0) scale('+scale+')';

        // Grid fades out & subtly shrinks
        var gridOut = smoothstep(0.35, 0.75, p);
        grid.style.opacity = String(1 - gridOut);
        grid.style.transform = 'scale(' + (1 - gridOut*0.06) + ')';
        gridMask.style.opacity = String(1 - gridOut);

        // Photo fades in; low-res first, then high-res
        var photoIn = smoothstep(0.45, 0.9, p);
        wrap.style.opacity = String(photoIn);
        if(photoIn > 0 && !wrap.hasAttribute('aria-hidden')){} else { wrap.removeAttribute('aria-hidden'); }

        // Crossfade low -> hi when hi is ready
        if(hiReady){ hi.style.opacity = 1; low.style.opacity = Math.max(0, 1 - photoIn*1.2); low.style.filter = 'blur(' + (18 - 18*photoIn) + 'px)'; }

        // Confetti when fully revealed & hi-res ready; allow retrigger when user backs up
        if(hiReady && p > 0.98 && !fired){ fired=true; confettiBurst(); }
        if(p < 0.85 && fired){ fired=false; } // retrigger window

        requestAnimationFrame(onScroll);
      }
      requestAnimationFrame(onScroll);
    })();

    // Confetti
    function confettiBurst(){
      var c=document.getElementById('confetti');
      c.hidden=false; c.width=innerWidth; c.height=innerHeight;
      var ctx=c.getContext('2d'); var pieces=[]; var colors=['#c8a2ff','#ff4db3','#ffd08a','#ffffff'];
      for(var i=0;i<200;i++){
        pieces.push({x:Math.random()*c.width, y:-20-Math.random()*c.height*.3, r:2+Math.random()*4, a:Math.random()*Math.PI, s:1+Math.random()*3, 
          col:colors[(Math.random()*colors.length)|0], tilt:Math.random()*Math.PI});
      }
      (function tick(){
        ctx.clearRect(0,0,c.width,c.height);
        pieces.forEach(function(p){ p.y+=p.s*6; p.x+=Math.sin(p.a+=0.05)*2; p.tilt+=0.06; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.tilt); ctx.fillStyle=p.col; ctx.fillRect(-p.r,-p.r,p.r*2,p.r*2); ctx.restore(); });
        if(pieces.some(function(p){ return p.y < c.height+20;})) requestAnimationFrame(tick); else { c.hidden=true; ctx.clearRect(0,0,c.width,c.height); }
      })();
      window.addEventListener('resize', function(){ c.width=innerWidth; c.height=innerHeight; }, { once:true });
    }
  </script>
</body>
</html>
